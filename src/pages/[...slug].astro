---
import { type CollectionEntry, getCollection } from 'astro:content';
import NotePost from '../layouts/NotePost.astro';
import IndexPage from '../layouts/IndexPage.astro';
import { getNotes, getPubDateForNote, getSlugForNote, getTypeForNote } from '../components/Notes.astro';
import type { MarkdownInstance } from "astro";

export async function getStaticPaths() {
	return getNotes();
}

type Props = MarkdownInstance<Record<string, any>>;
const post = Astro.props;
const { Content } = post;

const pubDate = getPubDateForNote(post)
const isReadme = (/readme.md$/.test(post.file))
const type = getTypeForNote(post)
const slug = getSlugForNote(post)

console.log("Rendering ", post.file, " with pubDate ", pubDate, " and isReadme ", isReadme, " to ", JSON.stringify(post))
---

{(pubDate &&
<NotePost {...post} pubDate={pubDate} title={post.frontmatter.title} description={post.frontmatter.description}>
  <Content />
</NotePost>
)}
{( isReadme && 
  <meta charset="utf-8"/>
  <IndexPage {...post}>
    <article><Content /></article>
  </IndexPage>
)}
